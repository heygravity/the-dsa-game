document.addEventListener('DOMContentLoaded', () => {
    // Game elements
    const gameContainer = document.getElementById('game-container');
    const movesCountSpan = document.getElementById('moves-count');
    const resetButton = document.getElementById('reset-btn');
    const hintButton = document.getElementById('hint-btn');
    const nextLessonButton = document.getElementById('next-lesson-btn');
    const congratsMessage = document.getElementById('congrats-message');
    
    // Audio Effects
    const swapSound = new Audio("data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjQ1LjEwMAAAAAAAAAAAAAAA//tAwAAAAAAAAAAAAAAAAAAAAAAAABoR2RFSW5mbwAAAA8AAAAIAAADeGF2Y0efg5//+xDEAAAAAAPof4gsEAAAAAAB1AQR2AAAAAAB3d3cueG1wLm9yZwAAAAAAeG1wOkNyZWF0b3JUb29sAAAAAABMYXZjNTguNDUuMTAwAP/7EMQCAAACAAACA3gAc291bmRmb3JnZS5uZXQAAAAAAAAAP/7EMQCAAACAAACA3gAc291bmRmb3JnZS5uZXQAAAAAAAAA//sQxAgAAAIAAAIDeABzb3VuZGZvcmdlLm5ldAAAAAAAAAD/9BDEAQAIAAAAEAAADSAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAAD/9BDEBAAIAAAAEAAADSAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAAD/+xDEIAAACAAABA3gAAAAAAAAAAAAAAP/7EMQYAAAEAAAEAAAAAAAAAAAAAAAAAAAAA//sQxBsAAAEAAAEAAAAAAAAAAAAAAAAD/9BDEAQAIAAAAEAAADSAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAAD/9BDEBAAIAAAAEAAADSAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAAD/9BDECAAIAAAAEAAADSAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAAD/9BDEBgAIAAAAEAAADSAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAACAAAAP/sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//s-QxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//sQxBoAAAMAADSAAAA//-xDEIgAAAgAAAQN4AANwAAAAAAAAAAAAA//sQxBsAAAEAAAEAAAAAAAAAAAAAAAAAAAAA//sQxBgAAAEAAAEAAAAAAAAAAAAAAAAAAAAA//sQxBQAAAEAAAEAAAAAAAAAAAAAAAAAAAAA//sQxBQAIAAAAAEAAAD/9BDEAgAIAAAAEAAADSAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAAD/AAaniaAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIA");
    const winSound = new Audio("data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjQ1LjEwMAAAAAAAAAAAAAAA//tAwAAAAAAAAAAAAAAAAAAAAAAAABoR2RFSW5mbwAAAA8AAAAIAAADeGF2Y0efg5//+xDEAAAAAAPof4gsEAAAAAAB1AQR2AAAAAAB3d3cueG1wLm9yZwAAAAAAeG1wOkNyZWF0b3JUb29sAAAAAABMYXZjNTguNDUuMTAwAP/7EMQCAAACAAACA3gAc291bmRmb3JnZS5uZXQAAAAAAAAAP/7EMQCAAACAAACA3gAc291bmRmb3JnZS5uZXQAAAAAAAAA//sQxAgAAAIAAAIDeABzb3VuZGZvcmdlLm5ldAAAAAAAAAD/9BDEHQAIAAAAEAAADSAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAAD/9BDEIQAIAAAAEAAADSAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAAD/+xDEIAAACAAABA3gAAAAAAAAAAAAAAP/7EMQYAAAEAAAEAAAAAAAAAAAAAAAAAAAAA//sQxBsAAAEAAAEAAAAAAAAAAAAAAAAD/9BDEHQAIAAAAEAAADSAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAAD/9BDEIQAIAAAAEAAADSAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAAD/9-BDEJAAIAAAAEAAADSAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAAD/9BDEJwAIAAAAEAAADSAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAACAAAAP/sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQ-QxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//sQxCoAAAMAADSAAAA//-xDEIgAAAgAAAQN4AANwAAAAAAAAAAAAA//sQxBsAAAEAAAEAAAAAAAAAAAAAAAAAAAAA//sQxBgAAAEAAAEAAAAAAAAAAAAAAAAAAAAA//sQxBQAAAEAAAEAAAAAAAAAAAAAAAAAAAAA//sQxBQAIAAAAAEAAAD/9BDEAgAIAAAAEAAADSAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAAD/AAaniaAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIAAAANIA");

    // Game state
    let values = [];
    let moves = 0;
    let selectedBar = null;
    let isGameWon = false;
    const barCount = 6;

    // --- Game Initialization ---
    function createBars() {
        isGameWon = false;
        congratsMessage.classList.remove('visible'); // Hide message on reset
        gameContainer.innerHTML = '';
        values = Array.from({ length: barCount }, (_, i) => i + 1);
        shuffleArray(values);

        values.forEach((value, index) => {
            const bar = document.createElement('div');
            bar.classList.add('bar');
            bar.style.height = `${value * 35}px`;
            bar.dataset.value = value;
            bar.dataset.index = index;
            bar.addEventListener('click', onBarClick);
            gameContainer.appendChild(bar);
        });
        updateMoves(0);
    }

    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
    }

    // --- User Interaction ---
    function onBarClick(event) {
        if (isGameWon) return; // Prevent clicks after winning
        const clickedBar = event.currentTarget;
        removeHint();

        if (!selectedBar) {
            selectedBar = clickedBar;
            selectedBar.classList.add('selected');
        } else {
            if (selectedBar !== clickedBar) {
                 const selectedIndex = parseInt(selectedBar.dataset.index);
                 const clickedIndex = parseInt(clickedBar.dataset.index);
                 if (Math.abs(selectedIndex - clickedIndex) === 1) {
                    swapBars(selectedBar, clickedBar);
                    updateMoves(moves + 1);
                    checkWinCondition();
                }
            }
            selectedBar.classList.remove('selected');
            selectedBar = null;
        }
    }

    function swapBars(bar1, bar2) {
        swapSound.play();
        const tempValue = bar1.dataset.value;
        bar1.dataset.value = bar2.dataset.value;
        bar2.dataset.value = tempValue;

        const tempHeight = bar1.style.height;
        bar1.style.height = bar2.style.height;
        bar2.style.height = tempHeight;
    }

    // --- Game Logic & State ---
    function updateMoves(count) {
        moves = count;
        movesCountSpan.textContent = moves;
    }
    
    function checkWinCondition() {
        const bars = Array.from(gameContainer.children);
        const isSorted = bars.every((bar, i) => i === 0 || parseInt(bar.dataset.value) >= parseInt(bars[i-1].dataset.value));

        if (isSorted) {
            isGameWon = true;
            winSound.play();
            // Trigger win animation
            bars.forEach((bar, index) => {
                setTimeout(() => bar.classList.add('dance'), index * 100);
            });

            // Show congratulations message after animation
            setTimeout(() => congratsMessage.classList.add('visible'), 800);
        }
    }

    // --- Hint System ---
    function getHint() {
        if (isGameWon) return;
        removeHint(); // Clear previous hints
        const bars = Array.from(gameContainer.children);
        for (let i = 0; i < bars.length - 1; i++) {
            const val1 = parseInt(bars[i].dataset.value);
            const val2 = parseInt(bars[i + 1].dataset.value);
            if (val1 > val2) {
                bars[i].classList.add('hint');
                bars[i+1].classList.add('hint');
                return;
            }
        }
    }

    function removeHint() {
        document.querySelectorAll('.bar.hint').forEach(b => b.classList.remove('hint'));
    }

    // --- Event Listeners ---
    resetButton.addEventListener('click', createBars);
    hintButton.addEventListener('click', getHint);
    nextLessonButton.addEventListener('click', () => {
        alert('The next lesson is coming soon!');
    });
    
    // Set current year in footer
    document.getElementById('copyright-year').textContent = new Date().getFullYear();

    // Initial Load
    createBars();
});